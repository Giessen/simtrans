DEF {{name}} Transform {
  children [
    {%- for c in visual.children recursive %}
    {%- if c.shapeType == ShapeModel.SP_NONE %}
    Transform {
      {%- if c.children %}
      children [
        {{ loop(c.children)|indent(4, True) }}
      ]
      {%- endif %}
    }
    {%- endif %}
    {%- if c.shapeType == ShapeModel.SP_MESH %}
    Shape {
      appearance Appearance {
        material Material {
          diffuseColor 0.85 0.85 0.85
          specularColor 0.85 0.85 0.85
          emissiveColor 0.05 0.05 0.05
          shininess 0.5
        }
      }
      geometry IndexedFaceSet {
        coord Coordinate {
          point [
            {%- for n in c.children[0].vertex %}
            {{n[0]}} {{n[1]}} {{n[2]}},
            {%- endfor %}
          ]
        }
        coordIndex [
          {%- for n in c.children[0].vertex_index %}
          {{n[0]}}, {{n[1]}}, {{n[2]}}, -1,
          {%- endfor %}
        ]
        normalPerVertex FALSE
      }
    }
    {%- endif %}
    {%- endfor %}
  ]
}
